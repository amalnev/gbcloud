## Отчет по домашнему заданию к уроку №7.

### Выполненные работы.
1. Добавлено отслеживание событий DELETE в режиме мониторинга файловой системы.
2. Некоторые "косметические" изменения - вывод command prompt в консоль, результаты работы некоторых команд, выводимые в консоль, сделаны более читабельными. Добавлен вывод в консоль прогресса передачи файлов по сети.
3. Проведено тестирование основных сценариев работы программы, устранены некоторые баги.

### Проблемы
Как оказалось при подробном рассмотрении, Java WatchService плохо подходит для организации работы облачного хранилища в режиме мониторинга файловой системы: действие пользователя, которое должно отражаться в облако атомарно, может рассыпаться на несколько событий CREATE, DELETE и MODIFY. При этом нет взаимно однозначного соответствия между различными действиями пользователя над файловой системой и последовательностями событий WatchService. Более того, скорее всего, такие соответствия являются платформо-зависимыми и на разных файловых системах одинаковые действия пользователей могут вызывать разные последовательности событий WatchService. К примеру, переименование файла будет отслежено как DELETE -> CREATE -> MODIFY. Отражение этих событий в облако "как есть" - сработает, но будет крайне неэффективным, поскольку файл сначала удалится из облака, а затем перезальется. Копирование файла в отслеживаемой директории вызовет последовательность CREATE -> MODIFY -> MODIFY ... более или менее длинную в зависимости от размера файла. Заливка фала в облако в обработчике события MODIFY может привести к непредсказуемому результату. Если инструмент, выполняющий копирование файла, получает к нему монопольный доступ, то заливка просто не удастся. Если же монопольный доступ не запрашивается, то результат может быть непредсказуемым. Поэтому работа облачного хранилища в режиме мониторинга файловой системы остается в качестве демонстрационного примера, но не в качестве основного способа работы. Основным будет являться shell.

### Основные точки для Code Review
Поскольку проект содержит много классов, разбор всего кода на уроке не имеет большого значения, прошу при review обратить внимание на следующие основные места в коде, напрямую касающиеся тем, разбиравшихся на предыдущих уроках.
1. Организация клиент-серверного взаимодействия. Это следующие пакеты:
    1. **ru.malnev.gbcloud.client.transport** - реализация клиентов на Netty и java.nio
    2. **ru.malnev.gbcloud.server.transport** - реализация серверов на Netty и java.nio
    3. **ru.malnev.gbcloud.common.transport** - реализация передачи данных в виде сериализованных POJO.
2. Файловый ввод-вывод. Реализован в классах пакета **ru.malnev.gbcloud.common.filesystem**. Основная функциональность в классах **NioFileReader** и **NioFileWriter**. 
3. Мониторинг событий файловой системы. Класс **ru.malnev.gbcloud.common.filesystem.DirectoryWatcher**.

В принципе, это основные точки по котрым хотелось бы получить обратную связь при review. Про остальную архитектуру проекта вместе с демонстрацией того, зачем она вообще была так сильно усложнена, я расскажу сам, если данный проект пойдет на защиту.